# 3DGT-DDI

## file list

- datasets：Inside is the dataset. There are three folders, the official training set and test set of DDI2013 and the data set of DrugBank.
  The CSV file is saved in the **raw** folder inside each folder. After running the code, the processed dataset file **process.pt** will be generated in the **process** folder

- model：It stores the model parameter file generated after the code runs.

- runs：It stores the log file generated by **tensorboardx**

  

## run code

To train the 3DGT-DDI model in DDI2013 datasets:

```python
python ddi2013.py --train_root ../datasets/ddi_train/ --train_path train_smiles_pos.csv --test_root ../datasets/ddi_test/ --test_path test_smiles_pos.csv --batch_size 8 --epochs 300 --lr 2e-6 --weight_decay 1e-2 --model_name allenai/scibert_scivocab_uncased --num_class 5 --max_len 128 --emb_dim 64 --cutoff 10.0 --num_layers 6 --hidden_channels 128 --num_filters 128 --num_gaussians 50 --g_out_channels 32
```

To train the 3DGT-DDI model in DrugBank datasets:

```python
python drugbank.py --drugbank_root ../datasets/drugbank/ --drugbank_path drugbank.csv --batch_size 16 --epochs 200 --lr 2e-5 --weight_decay 1e-2 --num_class 2 --cutoff 10.0 --num_layers 6 --hidden_channels 128 --num_filters 128 --num_gaussians 50 --g_out_channels 32
```



## requirement

matplotlib==3.5.1
numpy==1.22.0
pandas==1.3.5
rdkit==2009.Q1-1
scikit_learn==1.0.2
tensorboardX==2.4.1
torch==1.10.1
torch_geometric==2.0.3
torch_scatter==2.0.9
tqdm==4.62.3
transformers==4.15.0
